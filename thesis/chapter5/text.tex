% Text for Chapter 5
\chapter{Inferring Heating Properties of ``Hot'' Plasmas in Active Region Cores}\label{ch:inferring_hot_plasma}
\thispagestyle{firstpageofchapterstyle}

% spell-checker: disable %
\begin{pycode}[chapter5]
name = 'chapter5'
ch5 = texfigure.Manager(
    pytex,
    os.path.join('.', name),
    number=5,
    **{k: os.path.join('.', name, v) for k,v in manager_opts.items()}
)
from synthesizAR.atomic import Element
from run_ebtel import run_ebtel
from dem import calculate_em, fit_slope, plot_hist
# Base ebtel++ configuration
base_config = {
    'total_time': 5e3,
    'tau': 0.1,
    'tau_max': 10,
    'loop_length': 4e9,
    'saturation_limit': 1,
    'force_single_fluid': False,
    'use_c1_loss_correction': True,
    'use_c1_grav_correction': True,
    'use_flux_limiting': True,
    'use_power_law_radiative_losses': True,
    'calculate_dem': False,
    'save_terms': False,
    'use_adaptive_solver': True,
    'adaptive_solver_error': 1e-8,
    'adaptive_solver_safety': 0.5,
    'c1_cond0': 6.0,
    'c1_rad0': 0.6,
    'helium_to_hydrogen_ratio': 0.075,
    'surface_gravity': 1.0,
    'heating': OrderedDict({
        'partition': 1.,
        'background': 3.5e-5,}),
}
# Simulation parameters
total_energy = 10.0
durations = [20.0, 40.0, 200.0, 500.0]
flux_limiters = [
    (1.0, True),
    (0.53, True),
    (1.0/6.0, True),
    (0.1, True),
    (1.0/30.0, True),
    (1.0, False)
]
bins_T = 10**(np.arange(4, 8.5, 0.02))*u.K

# Functions
def effective_temperature(ieq, nei, T):
    return T[[(np.fabs(ieq - nei[i,:])).sum(axis=1).argmin() for i in range(nei.shape[0])]]
\end{pycode}
% spell-checker: enable %

In this chapter, I discuss the presence of ``very hot'' plasma as a possible signature of impulsive nanoflare heating in the corona. Using the two-fluid EBTEL model, I simulate the differential emission measure distribution for a range of heating properties and discuss several effects which can limit the observability of high-temperature (\SIrange{8}{10}{\mega\kelvin}) plasma. While only the evolution of a single loop is considered here, \autoref{ch:modeling-observables} takes advantage of the forward modeling framework discussed in \autoref{ch:synthesizar} to simulate many thousands of loops. This chapter is adapted directly from \citet{barnes_inference_2016}.

\section{Introduction}\label{hot-plasma:sec:intro}

Observations of the magnetically-closed solar corona from the \textit{Hinode} \citep{kosugi_hinode_2007} and Solar Dynamics Observatory \citep[SDO,][]{pesnell_solar_2012} spacecraft have led, for the first time, to quantitative studies of the distribution of coronal plasma as a function of temperature, and preliminary deductions about the heating process \citep[see papers in][]{de_moortel_recent_2015}. The key to this has been the ability to make measurements of the corona over a wide range of temperatures using the EUV Imaging Spectrometer \citep[EIS,][]{culhane_euv_2007} and X-Ray Telescope \citep[XRT,][]{golub_x-ray_2007} instruments on \textit{Hinode}, as well as the Atmospheric Imaging Assembly \citep[AIA,][]{lemen_atmospheric_2012} on SDO. Underpinning this work is the concept of nanoflare heating of the corona. Nanoflares \citep[e.g.][see \autoref{sec:nanoflares}]{parker_nanoflares_1988} are small bursts of energy release, which, despite the implication in their name, have unknown magnitude and duration. While commonly attributed to small-scale magnetic reconnection, nanoflares can occur in other heating scenarios \citep[e.g.][]{ofman_self-consistent_1998}.

One example of this approach has been studies of \AR{} core loops \citep{warren_constraints_2011,warren_systematic_2012,winebarger_using_2011,tripathi_emission_2011,schmelz_cold_2012,bradshaw_diagnosing_2012,reep_diagnosing_2013,del_zanna_evolution_2015}. These are the brightest structures in \AR s, spanning the magnetic polarity line, and are observed over a wide range of temperatures. An important result has been the determination of the emission measure distribution as a function of temperature ($\emd[T]\sim n^2dh$) along a line-of-sight (LOS). These workers showed that the emission measure peaked at $T = T_\textup{peak} = $\SIrange{e6.5}{e6.6}{\kelvin} with $\emd[T_\textup{peak}]$ of order \SIrange{e27}{e28}{\cm\tothe{-5}}. Below $T_\textup{peak}$ a relation of the form $\emd[T] \propto T^a$ was found, with $2\lesssim a\lesssim 5$, where $a$ is the so-called emission measure slope (see \autoref{sec:em_slope}). This distribution can be understood by a combination of radiative cooling of the corona to space and an enthalpy flux to the transition region (TR) \citep[e.g.][]{bradshaw_cooling_2010,bradshaw_new_2010} and and has significant implications for nanoflare heating. Defining low- and high-frequency (LF and HF, respectively) nanoflares by the ratio of the average time between nanoflares on a magnetic strand or sub-loop ($\langle \twait \rangle$) to the plasma cooling time from the peak emission measure ($\tau_\textup{cool}$), LF nanoflares have $\langle \twait \rangle > \tau_\textup{cool}$ and HF nanoflares have $\langle \twait \rangle < \tau_\textup{cool}$. LF nanoflares have $a \sim$ 2 - 3 and thus do not account for many of the observations. In fact, \citet{cargill_active_2014} argued that these results implied a heating mechanism with $\langle \twait \rangle$ of order \SIrange{1000}{2000}{\second} between nanoflares, with the value of $\twait$ associated with each nanoflare being proportional to its energy. Such intermediate frequency (IF) nanoflares have different energy build-up requirements from the commonly assumed LF scenario \citep{cargill_active_2014}.

A second outcome of \AR{} studies is the detection of a ``hot'' non-flaring coronal component characterized by plasma with $T > T_\textup{peak}$, a long-predicted consequence of nanoflare heating \citep{cargill_implications_1994,cargill_diagnostics_1995}. This has been identified from \textit{Hinode} and SDO data \citep{reale_evidence_2009,schmelz_hinode_2009,testa_hinode/eis_2012}, and retrospectively from data obtained by the X-Ray Polychrometer (XRP) instrument flown on the Solar Maximum Mission \citep{del_zanna_elemental_2014}. While characterizing this emission is difficult \citep[e.g.][]{testa_temperature_2011,winebarger_defining_2012}, a similar scaling, $\emd[T] \propto T^{-b}$ has been claimed \citep[e.g.][]{warren_systematic_2012}, with $b$ of order \numrange{7}{10}, though \citeauthor{del_zanna_elemental_2014} find larger values. \citeauthor{warren_systematic_2012} quote typical errors of $\pm$ \numrange{2.5}{3} on these values due to the very limited data available above $T_\textup{peak}$ and \citeauthor{winebarger_defining_2012} have noted that the paucity of data from \textit{Hinode} at these temperatures could be missing significant quantities of plasma with $T > T_\textup{peak}$.
    
In an effort to diminish uncertainty in this high temperature ``blind spot'' in $\emd[T]$, \citet{petralia_thermal_2014} analyzed an \AR{} core by supplementing EIS spectral observations with broadband AIA and XRT measurements. By using concurrent observations from the  \SI{94}{\angstrom} channel of AIA and the Ti\_poly filter of XRT, the \citeauthor{petralia_thermal_2014} showed that the $\emd[T]$ peaked near $T_\textup{peak} = \SI{e6.6}{\kelvin}$ and had a weak, hot component. Additionally, \citet{miceli_x-ray_2012}, using the SphinX instrument \citep{sylwester_sphinx_2008,gburek_sphinx_2011}, analyzed full-disk X-ray spectra integrated over 17 days, during which time two prominent \AR s were present. \citeauthor{miceli_x-ray_2012} found that a two-temperature model was needed to fit the resulting spectrum, a strong \SI{3}{\mega\kelvin} component and a much weaker \SI{7}{\mega\kelvin} component.

More recent data has come from rocket flights. The Focusing Optics X-ray Solar Imager \citep[FOXSI,][]{krucker_focusing_2013} first flew in November 2012 and observed an \AR. A joint study with EIS and XRT by \citet{ishikawa_constraining_2014} suggested that while hot plasma existed up to \SI{10}{\mega\kelvin}, the \textit{Hinode} instruments over-estimated the amount of plasma there. A rocket flight reported by \citet{brosius_pervasive_2014} identified emission in an Fe XIX line with a peak formation temperature of $\SI{e6.95}{\kelvin}$ and reported an emission measure that was 0.59 times the emission formed at $\SI{e6.2}{\kelvin}$. More recently, a pair of rocket flights gave observations from the Amptek X123-SDD soft X-ray spectrometer \citep{caspi_new_2015}. This provided comprehensive coverage of the \SIrange{3}{60}{\angstrom} wavelength range. \citeauthor{caspi_new_2015} demonstrated that the emission in this range could be fit by an emission measure with a power-law distribution slope of roughly $b = 6$. While all of these observations are very suggestive of nanoflare heating, it should also be noted that pixel-averaging, long time averages and/or inadequate instrument spatial resolution may lead to contamination of the $\dem[T]$ by multiple structures along the LOS. It is desirable to obtain future measurements of plasma emission at $T>T_\textup{peak}$ from a single structure, such as a core \AR{} loop, along the LOS.

Several other workers have combined model results with observations in an effort to better elucidate nanoflare signatures. Using a hydrodynamic loop model, \citet{reale_solar_2011} showed that emission from impulsively heated sub-arcsecond strands is finely structured and that this predicted structure can also be found in \AR{} core emission as observed by the \SI{94}{\angstrom} channel of AIA. Most recently, \citet{tajfirouze_time-resolved_2016}, using a 0D hydrodynamic model, explored a large parameter space in event energy distribution, pulse duration, and number of loops. Using a probabilistic neural network, the authors compared their many forward-modeled light curves to  \SI{94}{\angstrom} AIA observations of a ``hot'' AR core. They found that the observed light curves were most consistent with a pulse duration of \SI{50}{\second} and a shallow event energy distribution, suggestive of nanoflare heating.

While the distributions of temperature and density above $T_\textup{peak}$ are likely to be determined by nanoflare heating and conductive cooling, there are several complications arising from the low density and high temperature present there. These are (i) the breakdown of the usual Spitzer description of thermal conduction which leads to slower conductive cooling, (ii) recognition that in cases of heating in a weakly collisional or collisionless plasma, electrons and ions need not have the same temperature since when one is heated preferentially the time for the temperature to equilibrate is longer than the electron conductive cooling time, and (iii) a lack of ionization equilibrium that can underestimate the quantity of the plasma with a given electron temperature.

Thus the aim of the this chapter and \citet[\citetalias{barnes_inference_2016-1} hereafter]{barnes_inference_2016-1} is to investigate this high temperature regime from a modeling viewpoint with the aim of obtaining information that can be of use in the interpretation of present and future observations. In this chapter I focus on single-nanoflare simulations in order to build up an understanding of the roles of the different pieces of physics. \citetalias{barnes_inference_2016-1} addresses the properties of nanoflare trains. Given the limitations of present observations, these results are in part predictive for a future generation of instruments. \autoref{hot-plasma:sec:phys_sum} addresses the methodology, including simple outlines of the physics expected from conductive cooling, the preferred heating of different species, and ionization non-equilibrium. \autoref{hot-plasma:sec:results} shows results for the single- and two-fluid models, and \autoref{hot-plasma:sec:discussion} provides discussion of the main points of the results.

\section{Summary of Relevant Physics}\label{hot-plasma:sec:phys_sum}

First, I consider the situation when a coronal loop (or sub-loop) cools in response to a nanoflare by the evolution of a single-fluid plasma $(T_e = T_i)$ along a magnetic field line. I deal with the case of electron-ion non-equilibrium in  \autoref{hot-plasma:subsec:two_fluid_theory}. The energy equation is,
\begin{equation}\label{hot-plasma:eq:energy_1d}
    \frac{\partial E}{\partial t} = -\frac{\partial}{\partial s}[v(E+P)] - \frac{\partial F_c}{\partial s} + Q - n^2\Lambda(T),
\end{equation}
where $v$ is the velocity, $E=\frac{p}{\gamma -1} + \rho\frac{v^2}{2}$, $F_c=-\kappa_0 T^{5/2}\frac{\partial T}{\partial s}$ is the heat flux, $Q$ is a heating function that includes both steady and time-dependent components, $\Lambda(T)=\chi T^{\alpha}$ is the radiative loss function in an optically thin plasma \citep[e.g.][]{klimchuk_highly_2008} and $s$ is a spatial coordinate along the magnetic field. In addition the equations of mass and momentum conservation are solved. These equations are closed by $p=2nk_BT$, the equation of state. For a given initial state and $Q$, the plasma evolution can then be followed.

In this chapter, two approaches are used to solve \autoref{hot-plasma:eq:energy_1d}. One uses the HYDRAD code \citep[see \autoref{sec:hydrad}]{bradshaw_influence_2013} which solves the full field-aligned hydrodynamic two-fluid equations. The second develops further the zero-dimensional Enthalpy Based Thermal Evolution of Loops (EBTEL) approach which solves for average coronal plasma quantities \citep{klimchuk_highly_2008,cargill_enthalpy-based_2012,cargill_enthalpy-based_2012-1,cargill_modelling_2015}. In this chapter I compare the HYDRAD and EBTEL results and outline some restrictions that apply to the use of EBTEL when modeling the hot coronal component. However, the value of the EBTEL approach lies in its simplicity and computational speed, and the consequent ability to model the corona as a multiplicity of thin loops for long times, as is done in \citetalias{barnes_inference_2016-1}. Such calculations remain challenging for field-aligned hydrodynamic models.

The derivation of the single-fluid EBTEL equations can be found in \citep[and see \autoref{sec:ebtel}]{klimchuk_highly_2008,cargill_enthalpy-based_2012}. EBTEL treats the corona and TR as separate regions, matched at the top of the TR by continuity of conductive and enthalpy fluxes. It produces spatially-averaged, time-dependent quantities (e.g. $\bar{T}(t),\bar{n}(t)$) in the corona and can also compute quantities at the loop apex and the corona/TR boundary. The single-fluid EBTEL equations are,
\begin{align}
    \frac{1}{\gamma - 1}\frac{d\bar{p}}{dt} =& \,\bar{Q} - \frac{1}{L}(R_C + R_{TR}), \label{hot-plasma:eq:energy_0d} \\
    \frac{\gamma}{\gamma - 1}(pv&)_0 + F_{c,0} + R_{TR} = 0, \label{hot-plasma:eq:tr_energy_0d} \\
    \frac{d\bar{n}}{dt} =& -\frac{c_2(\gamma - 1)}{2c_3\gamma Lk_B\bar{T}}(F_{c,0} + R_{TR}).\label{hot-plasma:eq:mass_0d}
\end{align}
Here an overbar denotes a coronal average, $F_{c,0} = -(2/7)\kappa_0 T_a^{7/2}/L$ is the heat flux at the top of the TR (see also \autoref{hot-plasma:subsec:hf_theory}), $R_C=\bar{n}^2\Lambda(\bar{T})L$, is the integrated coronal radiation, $R_{TR}$ is the integrated TR radiation, and $L$ is the loop half-length. The subscript ``0'' denotes a quantity at the top of the TR and ``$a$'' denotes a quantity at the loop apex. Solving this set of equations requires the specification of three parameters:  $c_1=R_{TR}/R_C$, $c_2=\bar{T}/T_a$, and $c_3=T_0/T_a$. $c_2$ and $c_3$ can be taken as constant, with values of 0.9 and 0.6 respectively. \citet{cargill_enthalpy-based_2012} discuss the full implementation of $c_1 = c_1(T_a,L)$ and \autoref{sec:c1-correction} provides a detailed discussion of the additional corrections applied to $c_1$ in order to ensure better agreement with HYDRAD for impulsive heating scenarios. \autoref{hot-plasma:eq:energy_0d} is a statement of energy conservation in the combined corona and TR. \autoref{hot-plasma:eq:tr_energy_0d} is the TR energy equation: if the heat flux into the TR is greater (smaller) than its ability to radiate then there is an enthalpy flux into (from) the corona. \autoref{hot-plasma:eq:mass_0d} combines \autoref{hot-plasma:eq:tr_energy_0d} with that of mass conservation.

\subsection{Heat Flux Limiters}\label{hot-plasma:subsec:hf_theory}
    
It is well known that thermal conduction deviates from the familiar Spitzer-H{\"a}rm formula \citep{spitzer_transport_1953} at high temperatures \citep[e.g.][]{ljepojevic_heat_1989}. There is a firm upper limit on the heat flux: the free-streaming limit, $F_s=(1/2)fnk_BTV_e$, where $V_e$ is the electron thermal speed and $f$, a dimensionless constant, is determined from a combination of lab experiments, theory, and numerical models. The free-streaming flux is included in EBTEL and HYDRAD by a simple modification \citep{klimchuk_highly_2008},
\begin{equation}
    F_{c,0} = \frac{F_cF_s}{\sqrt{F_c^2 + F_s^2}},
\end{equation}
where $F_c$ is the Spitzer-H{\"a}rm heat flux. Smaller values of $f$ limit the heat flux to a greater degree. There is some disagreement on the optimal value of $f$. \citet{luciani_nonlocal_1983} use $f=0.1$ while \citet{karpen_nonlocal_1987} use $f=0.53$, and \citet{patsourakos_coronal_2005} choose $f=1/6$. Unless explicitly stated otherwise, I use $f = 1$ in order to compare EBTEL results with those of HYDRAD \citep[see appendix of][]{bradshaw_influence_2013}. The main aspect of inclusion of a free-streaming limit is to slow down conductive cooling. Other conduction models \citep[e.g. the non-local model discussed in the coronal context by][]{karpen_nonlocal_1987,ciaravella_non-local_1991,west_lifetime_2008} are not considered here since they lead to similar generic results.

\subsection{Two-fluid Modeling}\label{hot-plasma:subsec:two_fluid_theory}
    
In some parameter regimes nanoflare heating can also induce electron-ion non-equilibrium if the heating timescale is shorter than the electron-ion equilibration timescale. Interactions between electrons and ions in a fully-ionized hydrogen plasma like the solar corona are governed by binary Coulomb collisions. Thus, the equilibration timescale is $\tau_{ei}=1/\nu_{ei}$, where $\nu_{ei}$ is the collision frequency and is given by,
\begin{equation}\tag{\ref{eq:col_freq}}
    \nu_{ei} = \frac{16\sqrt{\pi}}{3}\frac{e^4}{m_em_i}\left(\frac{2k_BT_e}{m_e}\right)^{-3/2}n\ln{\Lambda},
\end{equation}
where $T_e$ is the electron temperature, $m_e,m_i$ are the electron and ion masses respectively, and $\ln{\Lambda}$ is the Coulomb logarithm \citep[see both Equation 2.5e and Section 3 of][]{braginskii_transport_1965}. For $n\sim\SI{e9}{\per\cubic\cm}$ and $T_e\sim\SI{e7}{\kelvin}$, parameters typical of nanoflare heating, $\tau_{ei}\approx\SI{800}{\second}$. Thus, any heating that occurs on a timescale less than \SI{800}{\second}, such as a nanoflare with a duration of $\tau\le\SI{100}{\second}$, will result in electron-ion non-equilibrium. While chromospheric evaporation during and after the nanoflare will increase $n$ and thus decrease $\nu_{ei}$, I argue that during the early heating phase, $\tau_{ei}\gg\tau$, with \SI{800}{\second} being an upper bound on $\tau_{ei}$.

While it is often assumed that the electrons are the recipients of the prescribed coronal heating function, ion heating in the solar corona should not be discounted since the exact mechanism behind coronal heating is still unknown. For example, ions may be heated via ion-cyclotron wave resonances \citep[e.g.][]{markovskii_intermittent_2004} or magnetic reconnection \citep[e.g.][]{ono_ion_1996,drake_onset_2014}. To address this possibility and include effects due to electron-ion non-equilibrium, I apply the EBTEL analysis outlined in \citet{klimchuk_highly_2008} to the two-fluid hydrodynamic equations in the form given in the appendix of \citet{bradshaw_influence_2013}. Such an approach allows for efficient modeling of a two-component impulsively-heated coronal plasma, and will be used extensively in \citetalias{barnes_inference_2016-1}.

The two-fluid EBTEL equations are derived fully in \autoref{sec:ebtel-two-fluid} and are restated here for convenience,
\begin{align}
    \frac{d}{dt}p_e =& \frac{\gamma - 1}{L}(\psi_{TR} - R_C(1 + c_1)) + k_Bn\nu_{ei}(T_i - T_e) + (\gamma - 1)\bar{Q}_e,\tag{\ref{eq:press_e_0d_2fl}} \\
    \frac{d}{dt}p_i =& -\frac{\gamma - 1}{L}\psi_{TR} + k_Bn\nu_{ei}(T_e - T_i) + (\gamma - 1)\bar{Q}_i,\tag{\ref{eq:press_i_0d_2fl} }\\
    \frac{d}{dt}n =& -\frac{\xi}{1+\xi}\frac{c_2(\gamma - 1)}{c_3L\gamma k_B\bar{T}_e}(F_{ce,0} + F_{ci,0} + c_1R_C),\tag{\ref{eq:mass_0d_2fl}}
\end{align}
This set of equations is closed by the equations of state $p_e=k_BnT_e$ and $p_i=k_BnT_i$. While the notation above is largely self-evident, the additional term $\psi_{TR}$, which originates in the need to maintain charge and current neutrality, is defined by \autoref{eq:psi_TR}.

\subsection{Ionization Non-Equilibrium}\label{hot-plasma:subsec:nei_theory}

Ionization non-equilibrium has long been known to be an issue in the interpretation of data from the impulsive phase of flares, and more recently it has been discussed in the context of nanoflares \citep{bradshaw_explosive_2006,reale_nonequilibrium_2008}. The main issue is that when a tenuous plasma is heated rapidly, it takes a certain time to reach ionization equilibrium so that the ionization states present do not reflect the actual (electron) temperature, assuming that the heating occurs mainly to electrons (see \autoref{hot-plasma:subsec:two_fluid_theory} and \autoref{hot-plasma:subsec:two-fluid-res}) rather than the heavier ions such as Fe that contribute to the observed radiation. If the heating is sustained, then eventually ionization equilibrium will be reached, and this may occur in moderate to large flares. However, for nanoflares that may last for anywhere between a few seconds and a few minutes, a different scenario arises in which on termination of heating, rapid conductive cooling arises, so that the high ionization states may never be attained. See \autoref{sec:nei} for further discussion of non-equilibrium charge states.

\citet{bradshaw_explosive_2006}, \citet{reale_nonequilibrium_2008} and \citet{bradshaw_numerical_2009} have all addressed this point using slightly different approaches, but with similar conclusions, namely that short nanoflares in a low-density plasma are unlikely to be detectable. In this chapter, I develop this work further to assess how the results in the first parts of \autoref{hot-plasma:sec:results} are altered. Following these authors, I calculate an ``effective temperature'' ($T_{eff}$) as a proxy for the deviation from ionization equilibrium. This involves taking a time-series of $T$ and $n$ (e.g. from EBTEL), using the method described in \autoref{ap:nonequilibrium_implicit} to calculate the fractional ionization of as many states of various elements as needed, and then calculating $T_{eff}$ as described in \citet{bradshaw_numerical_2009}. I consider all ionization states of Fe.

The feature that will prove of great relevance in these results is that despite the different nanoflare durations, $T_{eff}$ does not exceed \SI{10}{\mega\kelvin}. There is also an ``overshoot'' of $T_{eff}$ when it reaches its maximum value: this is saying that collisions are still not strong enough for the adjustment of the ionization state to be instantaneous.

\section{Results}\label{hot-plasma:sec:results}

I now show a series of simulations of a single nanoflare using the zero-dimensional two-fluid hydrodynamic EBTEL model and the HYDRAD code. \citetalias{barnes_inference_2016-1} discusses long trains of multiple nanoflares of varying frequency in multiple loops.

An important output of all these models is the coronal emission measure. In EBTEL the emission measure for the entire coronal part of the loop is calculated using the familiar expression $\mathrm{EM}=n^2(2L)$, where $L$ is the loop half-length. I consider a temperature range of $4.0\le\log{T}\le8.5$ with bin sizes of $\Delta\log{T}=0.02$. At each time $t_i$, the spatially-averaged coronal temperature $\bar{T}$, weighted by $\bar{n}_i^2(2L)$, where $\bar{n}_i$ is the spatially-averaged number density at $t_i$, is binned in temperature. The emission measure in each bin is then averaged over the entire simulation period. When measured observationally, $\mathrm{EM}(T)$ is a LOS quantity. The emission measure from HYDRAD is calculated using quantities averaged over the upper 90\% of the loop which corresponds to the coronal portion of the loop.

\subsection{Single-fluid Parameter Variations}\label{hot-plasma:subsec:sf_par_var}

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=1,
    height_ratio=2/3,
))
ax1 = plt.subplot2grid((2,2), (0,0))
ax2 = plt.subplot2grid((2,2), (1,0))
ax3 = plt.subplot2grid((2,2), (0,1), rowspan=2)
for i,tau in enumerate(durations):
    # EBTEL
    # Configure EBTEL run
    config = copy.deepcopy(base_config)
    config['force_single_fluid'] = True
    config['heating']['partition'] = 0.5
    config['heating']['events'] = [{'event': {
        'magnitude': 2 * total_energy/tau,
        'rise_start': 0.,
        'rise_end': tau/2.,
        'decay_start': tau/2.,
        'decay_end': tau,
    }}]
    res = run_ebtel(config, EBTEL_DIR)
    # Plot temperature and density
    ax1.plot(res['time'], res['electron_temperature'].to(u.MK), color=PALETTE[i],
             label=f'$\\tau={tau:.0f}$' + r' \si{\second}',)
    ax2.plot(res['time'], res['density']/1e8, color=PALETTE[i])
    # Plot emission measure
    bins, em = calculate_em(
        res['time'],
        res['electron_temperature'],
        res['density'],
        2*config['loop_length'],
        bins_T=bins_T,
        interpolate=True,
    )
    plot_hist(ax3, em.value, bins.value, color=PALETTE[i],)
    # HYDRAD
    # Read results
    with h5py.File(os.path.join(ch5.data_dir, 'hydrad_results.h5'), 'r') as hf:
        t = u.Quantity(hf['time'], hf['time'].attrs['unit'])
        T = u.Quantity(hf[f'/single/tau{tau:.0f}/electron_temperature'],
                       hf[f'/single/tau{tau:.0f}/electron_temperature'].attrs['unit'])
        n = u.Quantity(hf[f'/single/tau{tau:.0f}/density'],
                       hf[f'/single/tau{tau:.0f}/density'].attrs['unit'])
    # Plot temperature and density
    ax1.plot(t, T.to(u.MK), color=PALETTE[i], ls=':')
    ax2.plot(t, n/1e8, color=PALETTE[i], ls=':')
    # Plot emission measure
    bins, em = calculate_em(t, T, n, 2*config['loop_length'], bins_T=bins_T)
    plot_hist(ax3, em.value, bins.value, color=PALETTE[i], linestyle=':')
    
# Limits and scales
ax1.set_xlim(0.5, config['total_time'])
ax2.set_xlim(0.5, config['total_time'])
ax1.set_ylim(0, 25)
ax2.set_ylim(0, 50)
ax1.set_xscale('log')
ax2.set_xscale('log')
ax3.set_xscale('log')
ax3.set_yscale('log')
ax3.set_ylim([1e+23, 1e+28])
ax3.set_xlim([10**5.5, 10**7.5])
ax1.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
ax1.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
ax2.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4,))
ax3.yaxis.tick_right()
ax3.yaxis.set_label_position('right')
ax3.yaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=3))
# Legend
ax1.legend(frameon=False, ncol=len(durations), loc='lower center',
           bbox_to_anchor=(1.02 , 1.01))
# Labels
ax1.set_ylabel(r'$T$ $[\si{\mega\kelvin}]$')
ax2.set_ylabel(r'$n$ $[\num{e8}\si{\per\cubic\cm}]$')
ax2.set_xlabel(r'$t$ $[\si{\second}]$')
ax3.set_ylabel(r'$\textup{EM}(T)$ $[\si{\cm\tothe{-5}}]$')
ax3.yaxis.set_label_position('right')
ax3.set_xlabel(r'$T$ $[\si{\kelvin}]$')
plt.subplots_adjust(hspace=0.03, wspace=0.025)
# Save
tfig = ch5.save_figure('hot-plasma:sf-tnem', fext='.pgf')
tfig.caption = r'\textit{Left:} Temperature (upper panel) and density (lower panel) profiles for a loop with $2L=\SI{80}{\mega\m}$. Each heating profile is triangular in shape with a steady background heating of $H_{bg}=\SI{3.5e-5}{\erg\per\cubic\cm\per\second}$. The duration of the heating pulse is varied according to $\tau=\SIlist[list-final-separator = {,}]{20;40;200;500}{\second}$, with each value of $\tau$ indicated by a different color, as shown in the right panel. The total energy injected into the loop is fixed at \SI{10}{\erg\per\cubic\cm}. Note that time is shown on a log scale to emphasize the behavior of the heating phase. \textit{Right:} Corresponding $\emd[T]$ for each pulse duration $\tau$. The relevant parameters and associated colors are shown in the legend. $\emd[T]$ is calculated according to the procedure outlined in the beginning of \autoref{hot-plasma:sec:results}. In all panels, the solid (dotted) lines show the corresponding EBTEL (HYDRAD) results (see \autoref{hot-plasma:subsubsec:hydrad_comparison_sf}).'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

\subsubsection{Varying Pulse Duration}\label{hot-plasma:subsubsec:pulse_res}

In the first set of results I assume the plasma behaves as a single fluid, use a flux limiter of $f=1$, and ignore ionization non-equilibrium. The solid curves in \autoref{fig:hot-plasma:sf-tnem} show average temperature (upper left panel) and density (lower left panel) as a function of time for a single nanoflare in a loop with $2L = \SI{80}{\mega\m}$ where the EBTEL approach is used.  The heating function takes the form of a triangular pulse for four different pulse durations, $\tau=\SIlist[list-final-separator = {, }]{20;40;200;500}{\second}$, as indicated by the legend. The peak heating rate is varied such that the total energy input is \SI{10}{\erg\per\cubic\cm} for all cases. These parameters correspond roughly to bright AR core loops \citep{warren_systematic_2012}. In order to ensure that the temperature and density do not become negative, a small background heating of magnitude $H_{bg}=\SI{3.5e-5}{\erg\per\cubic\cm\per\second}$ is enforced at all times. It can be seen that shorter pulses give higher temperatures, as expected. Furthermore, in this early heating phase, one would expect the maximum temperature to scale roughly as $H_0^{2/7}$ (where $H_0$ is the peak heating rate); this is approximately what is found. On the other hand, the different pulse durations give approximately the same maximum density, with the shortest pulse reaching its peak value roughly \SI{200}{\second} before the longest.

The solid lines in the right panel of \autoref{fig:hot-plasma:sf-tnem} show the corresponding EBTEL emission measure distributions, $\emd[T]$. The temperature of maximum emission ($T_\textup{peak}$) and the peak emission measure ($\emd[T_\textup{peak}]$)are the same in all cases and are consistent with those found in the studies of AR core loops \citep[e.g.][]{warren_systematic_2012}. While shorter pulses lead to higher initial temperatures, the shape of the emission measure below $T_\textup{peak}$ is independent of the properties of the heating pulse, indicating that this part of the emission measure distribution cannot provide information about the actual nanoflare duration or intensity. All cases show evidence of the heating phase, namely the bump on $\mathrm{EM}(T)$ at $\log{(T)}=\numlist[list-final-separator = {,}]{6.85;7;7.2;7.3}$. Below these bumps to just above $T = T_\textup{peak}$, $\emd[T]$ scales as $T^{-5}-T^{-5.5}$ for all cases, again indicating that information about the heating process is lost at these temperatures. However, detection of emission above $T_\textup{peak}$ in a single structure would still be evidence for nanoflare heating, though of undetermined duration.

For integration over the lifetime of unresolved structures lying transverse to the LOS, one can write down an expression $\emd[T] \sim n^2\tau_\textup{cool}(n, T)$ which simply states that what matters for determining $\emd[T]$ is how long the plasma spends at any given temperature \citep[e.g.][]{cargill_implications_1994,cargill_nanoflare_2004}. For an analytic solution for the cooling, one can formally define $\tau_{cool}(n, T) = (T/(dT/dt))$. In the absence of a formal solution, order of magnitude scalings can be used: the difference with analytic solutions being a numerical factor. To obtain an expression $\emd[T]\propto T^{-b}$, one needs to provide a relation between $T$ and $n$. For conductive cooling of the corona, one can write $\tau_{cool} \sim nL^2T^{-5/2}$, giving $\emd[T]\sim n^3L^2T^{-5/2}$. In determining the relationship between $T$ and $n$, two limits are those of constant density and constant pressure. The former gives static conductive cooling \citep[e.g.][]{antiochos_influence_1976} and the latter evaporative cooling with constant thermal energy \citep[e.g.][]{antiochos_evaporative_1978}, which then lead to $b = \numlist[list-pair-separator = {, }]{5/2;11/2}$, respectively. Fitting the EBTEL $\emd[T]$ results for $\tau\le200$ s (see right panel of \autoref{fig:hot-plasma:sf-tnem}) to $T^{-b}$ on $10^{6.8}<T<10^{7}$ K yields $b\sim4.5-5$ which are more consistent with the latter.

\subsubsection{HYDRAD Comparison}\label{hot-plasma:subsubsec:hydrad_comparison_sf}

I now compare EBTEL and HYDRAD results for the different values of $\tau$. The dotted lines in all three panels of \autoref{fig:hot-plasma:sf-tnem} show the corresponding HYDRAD results, where averaging is over the upper 90\% of the loop. The background heating in the two codes has been adjusted to ensure that EBTEL and HYDRAD start with the the same initial density since the initial temperature rise will depend on the assumed background density.

There is good agreement between the HYDRAD and EBTEL results for $\tau\ge\SI{200}{\second}$ with the well-documented result that EBTEL gives somewhat higher density maxima than HYDRAD \citep[see][]{cargill_enthalpy-based_2012}. For $\tau=\SIlist[list-pair-separator = {, }]{20;40}{\second}$, while the peak temperatures are at a level of agreement consistent with previous work \citep{cargill_enthalpy-based_2012}, there are notable differences in the initial temperature decay from the maximum in the upper left panel of \autoref{fig:hot-plasma:sf-tnem} due to the difference in the initial density response.

It can be seen that the EBTEL density begins to rise almost immediately following the onset of heating, while there is a lag in the HYDRAD density. This is due to a delay in the upflow of material from the TR because a finite time is required to get material moving up the loop, an effect absent from 0D models. The slower density rise seen with HYDRAD leads to the faster conductive cooling. Another feature of the short pulses is the very spiky density profile as a function of time. This is a well-known effect, particularly in flare simulations, and is due to pairs of oppositely-directed flows colliding at the loop top, and subsequently bouncing back and forth.

As a result of this discrepancy in the density behavior, while the emission measure calculated from the EBTEL model ``sees'' temperatures well in excess of 10 MK for short pulses, in the HYDRAD model this will not be the case. This is evident from the short pulses in the right panel of \autoref{fig:hot-plasma:sf-tnem}: the emission above 10 MK predicted by EBTEL is not present in the HYDRAD runs, the emission cutting off just above \SI{e7}{\kelvin}. For the longer pulses, EBTEL still shows emission at higher temperatures, but the difference with HYDRAD is evident now over a smaller temperature range. Also, the characteristic bumps on the emission measure seen with EBTEL are largely eliminated in the HYDRAD runs.

This regime of short heating pulses was not considered in earlier work using EBTEL, and the associated comparisons with field-aligned hydrodynamic codes \citep{klimchuk_highly_2008,cargill_enthalpy-based_2012}, where pulses of order \SI{200}{\second} or greater were considered. Other workers have used short pulses with EBTEL, albeit much less intense \citep{tajfirouze_euv_2016,tajfirouze_time-resolved_2016}. Clearly the more gentle the heating profile used, the slower the rise in the EBTEL density, leading to results closer to those found using HYDRAD. Thus it appears that caution is warranted in the use of approximate models for short, intense heating pulses. This restriction only applies to the high temperature regime: as can be seen from \autoref{fig:hot-plasma:sf-tnem}, the emission measure profiles below \SI{e6.8}{\kelvin} are not affected. Nonetheless, the absence of emission near \SI{10}{\mega\kelvin} for short pulses constitutes one of many obstacles to quantifying any hot plasma component due to nanoflares.

\subsubsection{Heat Flux Limiter}\label{hot-plasma:subsubsec:hf_res}

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=0.65,
    height_ratio=1,
))
ax = fig.gca()
for i,fl in enumerate(flux_limiters):
    config = copy.deepcopy(base_config)
    config['force_single_fluid'] = True
    config['heating']['partition'] = 0.5
    config['heating']['events'] = [{'event': {
        'magnitude': 2*total_energy/durations[2],
        'rise_start': 0.,
        'rise_end': durations[2]/2.,
        'decay_start': durations[2]/2.,
        'decay_end': durations[2],
    }}]
    config['saturation_limit'] = fl[0]
    config['use_flux_limiting'] = fl[1]
    res = run_ebtel(config, EBTEL_DIR)
    bins, em = calculate_em(
        res['time'],
        res['electron_temperature'],
        res['density'],
        2*config['loop_length'],
        bins_T=bins_T,
        interpolate=True,
    )
    if fl[1]:
        frac = Fraction(fl[0]).limit_denominator()
        if frac.numerator == 1 and frac.denominator != 1:
            label = r'$f=$' + f'{frac.numerator:.0f}/{frac.denominator:.0f}'
        else:
            label = r'$f=$' + f'{fl[0]:.2f}'
    else:
        label='Spitzer'
    plot_hist(ax, em.value, bins.value, color=PALETTE[i], label=label, linestyle='-')

# Labels and limits
ax.set_xscale('log')
ax.set_yscale('log')
ax.set_ylim([1e+23, 1e+28])
ax.set_xlim([10**6.5, 10**7.5])
ax.legend(frameon=False, loc=1)
ax.yaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=3))
ax.xaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=1))
ax.set_ylabel(r'$\textup{EM}(T)$ $[\si{\cm\tothe{-5}}]$')
ax.set_xlabel(r'$T$ $[\si{\kelvin}]$')
# Save
tfig = ch5.save_figure('hot-plasma:sf-hf-em', fext='.pgf')
tfig.caption = r'$\emd[T]$ calculated from the single-fluid EBTEL model when only pure Spitzer conduction is used and when a flux limiter is imposed according to \autoref{hot-plasma:subsec:hf_theory}. In the free-streaming limit, five different values of $f$ are considered (see legend). The pulse duration is $\tau=200$ s. All other parameters are the same as those discussed in \autoref{hot-plasma:subsubsec:pulse_res}. Note that $\emd[T]$ is only shown for $T>T_\textup{peak}$ as the cool side of $\emd[T]$ is unaffected by the choice of $f$.'
tfig.figure_width = r'0.65\textwidth'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

\autoref{fig:hot-plasma:sf-hf-em} shows the effect of using a flux limiter versus Spitzer conduction on the emission measure distribution. Five different values of $f$ are shown: 1 \citep[consistent with HYDRAD]{bradshaw_influence_2013}, 0.53 \citep{karpen_nonlocal_1987}, $1/6$ \citep{patsourakos_coronal_2005}, 0.1 \citep{luciani_nonlocal_1983}, and $1/30$. The pulse duration is \SI{200}{\second} and only the EBTEL results are shown. Note that for this pulse length, the HYDRAD results are expected to be similar.

As expected, inclusion of a limiter extends $\emd[T]$ to higher temperatures, though this is only notable above 10 MK. As the temperature falls to this value, evaporative upflows have increased the coronal density so that the Spitzer description is recovered. Above 10 MK flux limiting gradually becomes important, albeit with a small emission measure. Using $f=0.53,1$ yield $\emd[T]$ that are not discernibly different from that produced by pure Spitzer conduction while $f=1/6,0.1$ extend $\emd[T]$ to significantly hotter temperatures. $f=1/30$, the most extreme flux limiter, yields an emission well above $\SI{e7.5}{\kelvin}$. Note that for all cases, $\emd[T]$ converges to the same value for $T\le\SI{10}{\mega\kelvin}$.

For flux-limited thermal conduction, $\tau_{cool} \sim LT^{-1/2}$ so that the parameter $b$ lies between 1/2 and 5/2, depending on the assumption about $n$. For $f = 1/30$, $b = 5/2$ is found in \autoref{fig:hot-plasma:sf-hf-em} by fitting $\emd[T]$ to $T^{-b}$ on $\SI{e7}{\kelvin} \le T \le \SI{e7.5}{\kelvin}$. Since the free-streaming limit slows conductive cooling relative to that given by Spitzer, the plasma will spend more time at any given temperature, leading to smaller values of $b$. Similar conclusions hold for other conduction models \citep[e.g. the non-local model discussed in the coronal context by][]{karpen_nonlocal_1987,west_lifetime_2008} since they all inhibit conduction. While limiting conduction is often regarded as an important process in coronal cooling, these results suggest that for nanoflare heating it may not be that important unless extreme values of the limiting parameter are used.

\subsection{Two-fluid Effects}\label{hot-plasma:subsec:two-fluid-res}

\subsubsection{Electron Heating}\label{hot-plasma:subsubsec:electron-heating}

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=1,
    height_ratio=2/3,
))
ax1 = plt.subplot2grid((3,2), (0,0))
ax2 = plt.subplot2grid((3,2), (1,0))
ax3 = plt.subplot2grid((3,2), (2,0))
ax4 = plt.subplot2grid((3,2), (0,1), rowspan=3)
for i,tau in enumerate(durations):
    # EBTEL
    # Configure EBTEL run
    config = copy.deepcopy(base_config)
    config['force_single_fluid'] = False
    config['heating']['partition'] = 1.0
    config['heating']['events'] = [{'event': {
        'magnitude': 2 * total_energy/tau,
        'rise_start': 0.,
        'rise_end': tau/2.,
        'decay_start': tau/2.,
        'decay_end': tau,
    }}]
    res = run_ebtel(config, EBTEL_DIR)
    # Plot temperature and density
    ax1.plot(res['time'], res['electron_temperature'].to(u.MK), color=PALETTE[i],
             label=f'$\\tau={tau:.0f}$' + r' \si{\second}',)
    ax2.plot(res['time'], res['ion_temperature'].to(u.MK), color=PALETTE[i],)
    ax3.plot(res['time'], res['density']/1e8, color=PALETTE[i])
    # Plot emission measure
    bins, em = calculate_em(
        res['time'],
        res['electron_temperature'],
        res['density'],
        2*config['loop_length'],
        bins_T=bins_T,
        interpolate=True,
    )
    plot_hist(ax4, em.value, bins.value, color=PALETTE[i],)
    # HYDRAD
    # Read results
    with h5py.File(os.path.join(ch5.data_dir, 'hydrad_results.h5'), 'r') as hf:
        t = u.Quantity(hf['time'], hf['time'].attrs['unit'])
        Te = u.Quantity(hf[f'/electron/tau{tau:.0f}/electron_temperature'],
                        hf[f'/electron/tau{tau:.0f}/electron_temperature'].attrs['unit'])
        Ti = u.Quantity(hf[f'/electron/tau{tau:.0f}/ion_temperature'],
                        hf[f'/electron/tau{tau:.0f}/ion_temperature'].attrs['unit'])
        n = u.Quantity(hf[f'/electron/tau{tau:.0f}/density'],
                       hf[f'/electron/tau{tau:.0f}/density'].attrs['unit'])
    # Plot temperature and density
    ax1.plot(t, Te.to(u.MK), color=PALETTE[i], ls=':')
    ax2.plot(t, Ti.to(u.MK), color=PALETTE[i], ls=':')
    ax3.plot(t, n/1e8, color=PALETTE[i], ls=':')
    # Plot emission measure
    bins, em = calculate_em(t, Te, n, 2*config['loop_length'], bins_T=bins_T)
    plot_hist(ax4, em.value, bins.value, color=PALETTE[i], linestyle=':')
    
# Limits
ax1.set_xlim(0.5, config['total_time'])
ax2.set_xlim(0.5, config['total_time'])
ax3.set_xlim(0.5, config['total_time'])
ax4.set_xlim([10**5.5, 10**7.5])
ax1.set_ylim(0, 25)
ax2.set_ylim(0, 8)
ax3.set_ylim(0, 50)
ax4.set_ylim([1e+23, 1e+28])
# Scales
ax1.set_xscale('log')
ax2.set_xscale('log')
ax3.set_xscale('log')
ax4.set_xscale('log')
ax4.set_yscale('log')
# Ticks
ax1.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
ax2.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
ax1.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
ax2.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
ax3.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4,))
ax4.yaxis.tick_right()
ax4.yaxis.set_label_position('right')
ax4.yaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=3))
# Legend
ax1.legend(frameon=False, ncol=len(durations), loc='lower center',
            bbox_to_anchor=(1.02 , 1.01))
# Labels
ax1.set_ylabel(r'$T_e$ $[\si{\mega\kelvin}]$')
ax2.set_ylabel(r'$T_i$ $[\si{\mega\kelvin}]$')
ax3.set_ylabel(r'$n$ $[\num{e8}\si{\per\cubic\cm}]$')
ax3.set_xlabel(r'$t$ $[\si{\second}]$')
ax4.set_ylabel(r'$\textup{EM}(T)$ $[\si{\cm\tothe{-5}}]$')
ax4.yaxis.set_label_position('right')
ax4.set_xlabel(r'$T$ $[\si{\kelvin}]$')
plt.subplots_adjust(hspace=0.04, wspace=0.025)
# Save
tfig = ch5.save_figure('hot-plasma:tfe-tnem', fext='.pgf')
tfig.caption = r'Two-fluid EBTEL simulations for $\tau=\SIlist[list-final-separator = {,}]{20;40;200;500}{\second}$ in which only the electrons are heated. \textit{Left}: Electron temperature (upper panel), ion temperature (middle panel), and density (lower panel). \textit{Right:} Corresponding $\emd[T]$ calculated according to \autoref{hot-plasma:sec:results}. The pulse durations and associated colors for all panels are shown in the legend. All parameters are the same as those discussed in \autoref{hot-plasma:subsubsec:pulse_res}. In all panels, the solid (dotted) lines show the corresponding EBTEL (HYDRAD) results.'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

I now use the two-fluid model to consider the role of separate electron or ion heating, focusing on cases when only the electrons or ions are heated in order to highlight the essential difference between the two scenarios. Intermediate cases of energy distribution will be considered in subsequent papers. The solid lines in the left panels of \autoref{fig:hot-plasma:tfe-tnem} show the electron temperature (upper panel), ion temperature (middle panel) and density (lower panel) as a function of time from the two-fluid EBTEL model for $\tau=\SIlist[list-final-separator = {,}]{20;40;200;500}{\second}$ for electron heating. The dotted lines show the corresponding HYDRAD results. The electrons now cool by a combination of thermal conduction and temperature equilibration, the latter becoming significant at 150 (450) s for short (long) pulses. The ions thus heat rather slowly, reaching a peak temperature of 5 MK, which overshoots the electron temperature at that time. The ions then cool via ion thermal conduction and equilibration, with $T_e \approx T_i$ after typically a few hundred seconds.

The solid lines in the right panel of \autoref{fig:hot-plasma:tfe-tnem} show the resulting $\emd[T]$. In the case of electron heating and $\tau<\SI{500}{\second}$, the emission measure slope over the temperature interval $\log{T_\textup{peak}}<\log{T}<6.8$ is considerably steeper compared to the single-fluid case. Recall that in the single-fluid case it is assumed that conduction is the only relevant cooling mechanism prior to the onset of radiative cooling such that under the assumption of constant pressure, $\emd[T] \propto T^{-11/2}$ (see \autoref{hot-plasma:subsec:sf_par_var}). When the electron and ion fluids are treated separately and only the electrons are heated, both of these assumptions break down. Following the onset of conductive cooling, $T_e \gg T_i$, but the loop has now begun to fill. The equilibration term plays the part of a cooling term so long as $T_e>T_i$ and is the dominant cooling mechanism for several hundred seconds in between the peak electron temperature and the peak density (see \autoref{fig:psi-tr-compare}). Thus, the expression for $\tau_\textup{cool}$ should include some contribution from the equilibration term in this temperature regime.

% spell-checker: disable %
\begin{pycode}[chapter5]
# Setup figure and axes
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=0.65,
    height_ratio=1,
))
ax = fig.gca()
ax2 = ax.twinx()

# Single fluid
config = copy.deepcopy(base_config)
config['force_single_fluid'] = True
config['heating']['partition'] = 0.5
config['heating']['events'] = [{'event': {
    'magnitude': 2*total_energy/durations[2],
    'rise_start': 0.,
    'rise_end': durations[2]/2.,
    'decay_start': durations[2]/2.,
    'decay_end': durations[2],
}}]
res_sf = run_ebtel(config, EBTEL_DIR)

# Two fluid
config['force_single_fluid'] = False
config['heating']['partition'] = 1.0
res_tf = run_ebtel(config, EBTEL_DIR)

# Plot pressure
lnp = ax.plot(res_sf['electron_temperature'], res_sf['electron_pressure']+res_sf['ion_pressure'], 
              color=PALETTE[0], ls='-', label=r'$p$')
lnpe = ax.plot(res_tf['electron_temperature'], res_tf['electron_pressure'],
               color=PALETTE[0], ls='--', label=r'$p_e$')
lnpi = ax.plot(res_tf['electron_temperature'], res_tf['ion_pressure'],
               color=PALETTE[0], ls=':', label=r'$p_i$')
lnpepi = ax.plot(res_tf['electron_temperature'], res_tf['electron_pressure']+res_tf['ion_pressure'], 
                 color=PALETTE[0], ls='-.', label=r'$p_e+p_i$')

# Plot density
lnns = ax2.plot(res_sf['electron_temperature'], res_sf['density'],
                color=PALETTE[1], ls='-', label=r'$n_s$')
lnnt = ax2.plot(res_tf['electron_temperature'], res_tf['density'],
                color=PALETTE[1], ls='--', label=r'$n_t$')

# Scales
ax.set_xscale('log')
ax2.set_xscale('log')
ax.set_yscale('log')
ax2.set_yscale('log')
# Limits
ax.set_xlim([10**5.5,10**7.2])
ax2.set_xlim([10**5.5,10**7.2])
ax.set_ylim(1e-2,1e1)
ax2.set_ylim(1e8,1e10)
# Labels
ax.set_xlabel(r'$T$ $[\si{\kelvin}]$')
ax.set_ylabel(r'$p$ $[\si{\dyne\per\square\cm}]$')
ax2.set_ylabel(r'$n$ $[\si{\per\cubic\cm}]$')
# Legend
lines = lnp + lnpe + lnpi + lnpepi + lnns + lnnt
labels = [l.get_label() for l in lines]
ax.legend(lines,labels,loc=2,frameon=False,ncol=2)

# Save
tfig = ch5.save_figure('hot-plasma:pnt-state-space', fext='.pgf')
tfig.caption = r'Pressure (left axis) and density (right axis) as a function of temperature for the $\tau=\SI{200}{\second}$ case. All parameters are the same as those discussed in \autoref{hot-plasma:subsubsec:pulse_res}. The single-fluid pressure $p$ and density $n$ are denoted by the solid blue and orange lines, respectively. The electron pressure, $p_e$, ion pressure, $p_i$, and two-fluid total pressure, $p_e+p_i$, are denoted by the dashed, dotted, and dot-dashed blue lines respectively. The two-fluid density is represented by the dashed orange line. Pressure, density, and temperature are all shown on a log scale.'
tfig.figure_width = r'0.65\textwidth'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

\autoref{fig:hot-plasma:pnt-state-space} shows pressure (blue lines) and density (orange lines) as a function of temperature for the $\tau=\SI{200}{\second}$ case; both the single-fluid case and the case where only the electrons are heated are shown. While $p_e+p_i$ (blue dotted line), the total pressure, like the single-fluid pressure $p$ (blue solid line) is constant over the interval $\SI{e6.65}{\kelvin}<T<\SI{e6.8}{\kelvin}$, the electron pressure, $p_e$ (blue dashed line) is not, meaning $n\propto T_e^{-1}$ is not a valid scaling law in the two-fluid, electron-heating case. Comparing the two-fluid density (dashed orange line) and the single-fluid density (solid orange line) easily confirms this. To derive an emission measure slope for the case in which only the electrons are heated, these effects must be accounted for in the $\mathrm{EM}(T)\sim n^2\tau_{cool}(n,T)$ scaling. Thus, while a power-law $b$ may be calculated by fitting the hot part of the $\mathrm{EM}(T)$ to $T^{-b}$, it is difficult to gain any physical insight from such a fit using the scaling discussed in \autoref{hot-plasma:subsubsec:pulse_res}.

\subsubsection{Ion Heating}\label{hot-plasma:subsubsec:ion_heating}

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=1,
    height_ratio=2/3,
))
ax1 = plt.subplot2grid((3,2), (0,0))
ax2 = plt.subplot2grid((3,2), (1,0))
ax3 = plt.subplot2grid((3,2), (2,0))
ax4 = plt.subplot2grid((3,2), (0,1), rowspan=3)
for i,tau in enumerate(durations):
    # EBTEL
    # Configure EBTEL run
    config = copy.deepcopy(base_config)
    config['force_single_fluid'] = False
    config['heating']['partition'] = 0.0
    config['heating']['events'] = [{'event': {
        'magnitude': 2 * total_energy/tau,
        'rise_start': 0.,
        'rise_end': tau/2.,
        'decay_start': tau/2.,
        'decay_end': tau,
    }}]
    res = run_ebtel(config, EBTEL_DIR)
    # Plot temperature and density
    ax1.plot(res['time'], res['electron_temperature'].to(u.MK), color=PALETTE[i],
                label=f'$\\tau={tau:.0f}$' + r' \si{\second}',)
    ax2.plot(res['time'], res['ion_temperature'].to(u.MK), color=PALETTE[i],)
    ax3.plot(res['time'], res['density']/1e8, color=PALETTE[i])
    # Plot emission measure
    bins, em = calculate_em(
        res['time'],
        res['electron_temperature'],
        res['density'],
        2*config['loop_length'],
        bins_T=bins_T,
        interpolate=True,
    )
    plot_hist(ax4, em.value, bins.value, color=PALETTE[i],)
    # HYDRAD
    # Read results
    with h5py.File(os.path.join(ch5.data_dir, 'hydrad_results.h5'), 'r') as hf:
        t = u.Quantity(hf['time'], hf['time'].attrs['unit'])
        Te = u.Quantity(hf[f'/ion/tau{tau:.0f}/electron_temperature'],
                        hf[f'/ion/tau{tau:.0f}/electron_temperature'].attrs['unit'])
        Ti = u.Quantity(hf[f'/ion/tau{tau:.0f}/ion_temperature'],
                        hf[f'/ion/tau{tau:.0f}/ion_temperature'].attrs['unit'])
        n = u.Quantity(hf[f'/ion/tau{tau:.0f}/density'],
                       hf[f'/ion/tau{tau:.0f}/density'].attrs['unit'])
    # Plot temperature and density
    ax1.plot(t, Te.to(u.MK), color=PALETTE[i], ls=':')
    ax2.plot(t, Ti.to(u.MK), color=PALETTE[i], ls=':')
    ax3.plot(t, n/1e8, color=PALETTE[i], ls=':')
    # Plot emission measure
    bins, em = calculate_em(t, Te, n, 2*config['loop_length'], bins_T=bins_T,)
    plot_hist(ax4, em.value, bins.value, color=PALETTE[i], linestyle=':')
    
# Limits
ax1.set_xlim(0.5, config['total_time'])
ax2.set_xlim(0.5, config['total_time'])
ax3.set_xlim(0.5, config['total_time'])
ax4.set_xlim([10**5.5, 10**7.5])
ax1.set_ylim(0, 8)
ax2.set_ylim(0, 190)
ax3.set_ylim(0, 40)
ax4.set_ylim([1e+23, 1e+28])
# Scales
ax1.set_xscale('log')
ax2.set_xscale('log')
ax3.set_xscale('log')
ax4.set_xscale('log')
ax4.set_yscale('log')
# Ticks
ax1.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
ax2.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
ax1.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
ax2.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
ax3.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4,))
ax4.yaxis.tick_right()
ax4.yaxis.set_label_position('right')
ax4.yaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=3))
# Legend
ax1.legend(frameon=False, ncol=len(durations), loc='lower center',
            bbox_to_anchor=(1.02 , 1.01))
# Labels
ax1.set_ylabel(r'$T_e$ $[\si{\mega\kelvin}]$')
ax2.set_ylabel(r'$T_i$ $[\si{\mega\kelvin}]$')
ax3.set_ylabel(r'$n$ $[\num{e8}\si{\per\cubic\cm}]$')
ax3.set_xlabel(r'$t$ $[\si{\second}]$')
ax4.set_ylabel(r'$\textup{EM}(T)$ $[\si{\cm\tothe{-5}}]$')
ax4.yaxis.set_label_position('right')
ax4.set_xlabel(r'$T$ $[\si{\kelvin}]$')
plt.subplots_adjust(hspace=0.04, wspace=0.025)
# Save
tfig = ch5.save_figure('hot-plasma:tfi-tnem', fext='.pgf')
tfig.caption = r'Two-fluid EBTEL simulations for $\tau=\SIlist[list-final-separator = {,}]{20;40;200;500}{\second}$ in which only the ions are heated. \textit{Left}: Electron temperature (upper panel), ion temperature (middle panel), and density (lower panel). \textit{Right:} Corresponding $\mathrm{EM}(T)$ calculated according to \autoref{hot-plasma:sec:results}. The pulse durations and associated colors for all panels are shown in the legend. All parameters are the same as those discussed in \autoref{hot-plasma:subsubsec:pulse_res}. In all panels, the solid (dotted) lines show the corresponding EBTEL (HYDRAD) results.'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

\autoref{fig:hot-plasma:tfi-tnem} shows the electron temperature (upper left panel), ion temperature (middle left panel), density (lower left panel) and the corresponding emission measure (right panel) for $\tau=\SIlist[list-final-separator = {,}]{20;40;200;500}{\second}$ when only the ions are heated. The solid lines show the two-fluid EBTEL results while the dotted lines show the corresponding HYDRAD results. Ion heating leads to significantly higher temperatures due to the relative weakness of ion thermal conduction, consistent with the expected enhancement of $(\kappa_{0,e}/\kappa_{0,i})^{2/7}$. The hot ions cool by a combination of weak ion thermal conduction and temperature equilibration. However, because the Coulomb coupling timescale during the early heating phase (when $T_i\gg T_e$ and the density is low) is much larger than the ion thermal conduction timescale, by the time the electrons can ``see'' the ions, they have cooled far below their peak temperature. The peak electron temperature in all cases lies below \SI{10}{\mega\kelvin}. Because $\mathrm{EM}(T)$ is constructed from the electron temperature, the emission measure never sees $T\ge\SI{e7}{\kelvin}$, with $\mathrm{EM}(T)$ being truncated sharply near \SI{e6.9}{\kelvin} for all values of $\tau$.

The reason for slower equilibration for ion heating can be seen by comparing the density plots in the lower left panels of \autoref{fig:hot-plasma:tfe-tnem} and \autoref{fig:hot-plasma:tfi-tnem}. These show that while the peak values of the density are similar for both heating mechanisms, the temporal behavior differs for ion heating with shorts pulses: for these cases, the density takes considerably longer to reach the maximum value. This can be attributed to the relative weakness of ion thermal conduction. Examination of \autoref{eq:0d_mass_sub} and \autoref{eq:psi_TR} shows that an upward enthalpy flux can only be effective for ion heating once temperature equilibration has become significant and an electron heat flux is established. In turn, once the upflow begins, the coronal density increases, making equilibration more effective. Thus, once temperature equilibration starts to be effective, these processes combine to give a rapid increase in density, as shown.

In the case where the heating pulse duration is long, $\tau=\SI{500}{\second}$, the difference between the two-fluid and single-fluid emission measure distributions is diminished. Because the electrons are heated slowly, they do not have much time to evolve out of equilibrium with the ions. This in turn heavily dampens the Coulomb exchange term, allowing the two populations to evolve together as a single fluid.

\subsubsection{HYDRAD Comparison}\label{hot-plasma:subsubsec:hydrad_comparison_tf}

The dotted lines in all panels of \autoref{fig:hot-plasma:tfe-tnem} and \autoref{fig:hot-plasma:tfi-tnem} show the corresponding HYDRAD results for both electron and ion heating, respectively. As in \autoref{hot-plasma:subsubsec:hydrad_comparison_sf}, the averaging is done over the upper 90\% of the loop and the background heating has been adjusted appropriately. For $\tau\ge200$ s, there is acceptable agreement in $n$, $T_e$, $T_i$, and $\mathrm{EM}(T)$.

For $\tau=20,40$ s, the upper and lower panels of \autoref{fig:hot-plasma:tfe-tnem} show discrepancies in $T_e$ and $n$ similar to those discussed in \autoref{hot-plasma:subsubsec:hydrad_comparison_sf}. The initial decay from the peak electron temperature is noticeably different in the EBTEL runs compared to the corresponding HYDRAD runs, again due to the difference in the initial density response. The discrepancies in the density are exacerbated in the electron heating case (compared to the single-fluid case) since all of the energy is partitioned to the electrons, resulting in a stronger electron heat flux and a subsequently stronger upflow. The right panel of \autoref{fig:hot-plasma:tfe-tnem} shows the effect of this premature rise in the density on $\mathrm{EM}(T)$ for these short pulses: while EBTEL predicts significant emission above 10 MK, the emission in the HYDRAD runs cuts off just below \SI{e6.9}{\kelvin}.

In the ion heating case, there is acceptable agreement in $T_e$, $n$, and $\mathrm{EM}(T)$. Notably, there is good agreement in $n$ even for the shortest heating pulses, $\tau=20,40$ s, though EBTEL still overestimates the peak density compared to the HYDRAD results.  Because no heat is supplied to the electrons directly, the electron heating timescale is set by the Coulomb collision frequency (see \autoref{eq:col_freq}), meaning energy is deposited to the electrons over a timescale much longer than \SI{20}{\second} or \SI{40}{\second}. The resulting slow evolution of $T_e$ leads to subsequently weaker upflows. Because of the much more gentle rise in density, the electrons are not able to ``see'' the ions until they have cooled well below \SI{10}{\mega\kelvin} (see \autoref{hot-plasma:subsubsec:ion_heating}).

In the middle panel on the left hand side of \autoref{fig:hot-plasma:tfe-tnem}, the ion temperature in HYDRAD is significantly greater than that of EBTEL in the late heating/early conductive cooling phase for $\tau=\SIlist[list-pair-separator = {, }]{20;40}{\second}$. These spikes in $T_i$ are due to steep velocity gradients that heat the ions through compressive heating and viscosity, two pieces of physics that are not included in EBTEL. Because ion thermal conduction is comparatively very weak, these sharp features in $T_i$ are not as efficiently smoothed out. For $\tau=\SIlist[list-pair-separator = {, }]{200;500}{\second}$, there is good agreement in $T_i$ between the EBTEL and HYDRAD results. Interestingly, the middle panel on the left hand side of \autoref{fig:hot-plasma:tfi-tnem} shows that EBTEL and HYDRAD predict similar behavior for $T_i$ though EBTEL significantly overestimates the ion temperature for $\tau=\SIlist[list-pair-separator = {, }]{20;40}{\second}$. As before, there is good agreement for $\tau=\SIlist[list-pair-separator = {, }]{200;500}{\second}$. 

\subsection{Ionization Non-Equilibrium}\label{hot-plasma:subsec:nei_res}

% spell-checker: disable %
\begin{pycode}[chapter5]
# Compute ionization equilibrium
T_grid = np.logspace(4,8.5,1000)*u.K
fe = Element('iron', T_grid)
ieq = fe.equilibrium_ionization()
rate_matrix = fe._rate_matrix()
\end{pycode}
% spell-checker: enable %

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=1,
    height_ratio=3/4,
))
for i, tau in enumerate(np.array(durations)[[0,-1]]):
    ax = fig.add_subplot(2, 1, i+1)
    j = np.argmin(np.fabs(np.array(durations) - tau))
    for p, b, ls in [(0.5, True, '-'), (1, False, '--'), (0, False, '-.')]:
        config = copy.deepcopy(base_config)
        config['force_single_fluid'] = b
        config['heating']['partition'] = p
        config['heating']['events'] = [{'event': {
            'magnitude': 2*total_energy/tau,
            'rise_start': 0.,
            'rise_end': tau/2.,
            'decay_start': tau/2.,
            'decay_end': tau,
        }}]
        res = run_ebtel(config, EBTEL_DIR)
        if i == 0:
            if p == 0.5:
                label = 'single'
            elif p == 1.0:
                label = 'electron'
            else:
                label = 'ion'
        else:
            label = None
        # Temperature
        ax.plot(res['time'], res['electron_temperature'].to(u.MK),
                ls=ls, color=PALETTE[j], label=label)
        # Effective temperature
        nei = fe.non_equilibrium_ionization(res['time'], res['electron_temperature'], res['density'],
                                            rate_matrix=rate_matrix, initial_condition=ieq,
                                            check_solution=False)
        Teff = effective_temperature(ieq, nei, T_grid)
        ax.plot(res['time'], Teff.to(u.MK), ls=ls, color='r')
    ax.set_xscale('log')
    ax.set_xlim(0.5, config['total_time'])
    ax.set_ylim([0,25] if i == 0 else [0,10])
    if i == 0:
        ax.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
        ax.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4, prune='lower'))
        ax.legend(loc=1, frameon=False,)
    else:
        ax.set_xlabel(r'$t$ $[\si{\second}]$')
        ax.yaxis.set_major_locator(matplotlib.ticker.MaxNLocator(nbins=4,))
    ax.set_ylabel(r'$T$ $[\si{\mega\kelvin}]$')
plt.subplots_adjust(hspace=0.02)
# Save
tfig = ch5.save_figure('hot-plasma:stf-Teff-compare', fext='.pgf')
tfig.caption = r'$T_{eff}$ (red) for pulse durations of \SI{20}{\second} (top panel) and \SI{500}{\second} (bottom panel) for the single-fluid case (solid) as well as the cases where only the electrons (dashed) or only the ions (dot-dashed) are heated. $T(t)$ profiles (i.e. assuming ionization equilibrium) for $\tau=\SI{20}{\second}$ (blue lines) and $\tau=\SI{500}{\second}$ (brown lines) for all three heating scenarios are repeated here for comparison purposes.'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

% spell-checker: disable %
\begin{pycode}[chapter5]
fig = plt.figure(figsize=texfigure.figsize(
    pytex,
    scale=1,
    height_ratio=1,
))
for i, tau in enumerate(np.array(durations)[[0,-1]]):
    ax = fig.add_subplot(2, 1, i+1)
    j = np.argmin(np.fabs(np.array(durations) - tau))
    for p, b, ls in [(0.5, True, '-'), (1, False, '--'), (0, False, '-.')]:
        config = copy.deepcopy(base_config)
        config['force_single_fluid'] = b
        config['heating']['partition'] = p
        config['heating']['events'] = [{'event': {
            'magnitude': 2*total_energy/tau,
            'rise_start': 0.,
            'rise_end': tau/2.,
            'decay_start': tau/2.,
            'decay_end': tau,
        }}]
        res = run_ebtel(config, EBTEL_DIR)
        if i == 0:
            if p == 0.5:
                label = 'single'
            elif p == 1.0:
                label = 'electron'
            else:
                label = 'ion'
        else:
            label = None
        # Temperature
        bins, em = calculate_em(
            res['time'],
            res['electron_temperature'],
            res['density'],
            2*config['loop_length'],
            bins_T=bins_T,
            interpolate=True)
        plot_hist(ax, em.value, bins.value, color=PALETTE[j], linestyle=ls, label=label)
        # Effective temperature
        nei = fe.non_equilibrium_ionization(res['time'], res['electron_temperature'], res['density'],
                                            rate_matrix=rate_matrix, initial_condition=ieq,
                                            check_solution=False)
        Teff = effective_temperature(ieq, nei, T_grid)
        bins,em = calculate_em(
            res['time'],
            Teff,
            res['density'],
            2*config['loop_length'],
            bins_T=bins_T,
            interpolate=True)
        plot_hist(ax, em.value, bins.value, color='r', linestyle=ls,)
    
    ax.set_xscale('log')
    ax.set_yscale('log')
    ax.set_xlim([10**6.5,10**7.5])
    ax.set_ylim([1e+23,1e+28])
    ax.yaxis.set_major_locator(matplotlib.ticker.LogLocator(base=10.0, numticks=3))
    if i == 0:
        ax.xaxis.set_major_formatter(matplotlib.ticker.NullFormatter())
        ax.xaxis.set_minor_formatter(matplotlib.ticker.NullFormatter())
        ax.legend(loc=1, frameon=False,)
    else:
        ax.set_xlabel(r'$T$ $[\si{\kelvin}]$')
    ax.set_ylabel(r'$\textup{EM}(T)$ $[\si{\cm\tothe{-5}}]$')
plt.subplots_adjust(hspace=0.02)
# Save
tfig = ch5.save_figure('hot-plasma:stf-emeff-compare', fext='.pgf')
tfig.caption = r'$\emd[T_{eff}]$ (red) for pulse durations of 20 s (top panel) and 500 s (bottom panel) for the single-fluid (solid), electron heating (dashed), and ion heating (dot-dashed) cases. $\emd[T]$ (i.e. assuming ionization equilibrium) for $\tau=20$ s (blue lines) and $\tau=500$ s (brown lines) for all three heating scenarios are repeated here for comparison purposes. Note that in both panels $\emd[T]$ is only shown for $\log{T}>\log{T_\textup{peak}}$.'
tfig.placement = '!h'
\end{pycode}
\py[chapter5]|tfig|
% spell-checker: enable %

The final set of results includes the approximate treatment of non-equilibrium ionization, again using the EBTEL approach. The red curves in the top (bottom) panel of \autoref{fig:hot-plasma:stf-Teff-compare} show $T_{eff}$ for $\tau=20\,(500)$ s for the single-fluid, electron heating, and ion heating cases. For comparison, equivalent results for $T$ (single-fluid) and $T_e$ (two-fluid) that assume ionization equilibrium are shown. For all cases, $T_{eff}$ never rises above \SI{10}{\mega\kelvin} for the short pulse and \SI{8}{\mega\kelvin} for the long pulse. Thus, for the short pulse, because a sufficiently long time is required to ionize the plasma, the hottest electron temperatures are never likely to be detectable. For the longer pulse, the slow heating gives the ionization states the opportunity to ``catch up''; thus $T_{eff}$ is a reasonable reflection of the actual plasma state.

The red curves in \autoref{fig:hot-plasma:stf-emeff-compare} show the corresponding $\mathrm{EM}(T_{eff})$. The effect of ionization non-equilibrium is to truncate  $\mathrm{EM}$ around or below \SI{10}{\mega\kelvin}. The bump on the distribution characteristic of the heating phase is also relocated to lower temperatures. This confirms the earlier comment that, at least for short pulses, the hot electron plasma above \SI{10}{\mega\kelvin} is undetectable. While the heating signature is shifted to smaller values of $T_{eff}$, one has no way of knowing the duration of the pulse that generates it. Thus it seems as if the temperature range $T_\textup{peak}<T<\SI{10}{\mega\kelvin}$ is the optimal one for searching for this hot component as well as direct signatures of the heating. However, it is difficult to ``map'' what would be seen in such a state of ionization non-equilibrium back to the real system.

\section{Discussion}\label{hot-plasma:sec:discussion}

This chapter has begun to address signatures of the so-called ``hot'' plasma component in the non-flaring corona, especially in \AR{} s, that is perceived as providing essential evidence for the existence of nanoflares. I have used zero-dimensional and field-aligned single- and two-fluid modeling to examine the possible signatures of a single nanoflare occurring in a low-density plasma. This corresponds to the simplest case of so-called ``low frequency'' (LF) nanoflares, where a coronal loop is heated by many events with the same energy and with a time between events longer than the characteristic cooling time such that the plasma is allowed cool significantly before being re-energized.

When an approximate single-fluid model assuming ionization equilibrium is used, the expected signatures of conductive cooling appear in the distribution of plasma as a function of temperature, as described by the emission measure. In particular, short nanoflares with duration $<\SI{100}{\second}$ should have a significant plasma component well above \SI{10}{\mega\kelvin}, and for longer duration events, significant plasma between the temperature of the maximum emission measure and \SI{10}{\mega\kelvin}. However, inclusion of several pieces of additional physics modifies this result considerably, in each case making it much less likely that any plasma that $>\SI{10}{\mega\kelvin}$ can be detected.

For short nanoflares, the time taken for conductively-heated chromospheric plasma to move into the coronal part of a loop is sufficiently long that the initial hot coronal plasma cools rapidly, contributing little to the emission measure such that, once the coronal density has increased, its temperature is below \SI{10}{\mega\kelvin}. This effect is less important for long duration nanoflares. Consideration of separate electron and ion heating shows that, while electron heating leads to similar results to the single fluid case, ion heating results in no emission measure at \SI{10}{\mega\kelvin} due to the principal electron heating mechanism being a relatively slow collisional process. Finally, relaxing the assumption of ionization equilibrium leads to a truncation of the emission measure below \SI{10}{\mega\kelvin}, since the time needed to create highly ionized states such as Fe XXI is longer than any relevant cooling time. In all cases the hot plasma, while still in the corona, is effectively ``dark''. In addition, characteristic structures in the emission measure profile that are a signature of the heating itself in simple models are all but eliminated.

These results suggest that while showing that such a ``hot'' plasma should exist in principle may not be difficult, characterizing the heating process from its observed properties may be a lot harder. Of course the work presented in this chapter is limited to LF nanoflares. Furthermore, \citet{cargill_active_2014} showed that the intermediate frequency nanoflare regime does have significant differences, in large part due to the range of densities in which the nanoflares occur. This is addressed fully, along with other parameter variations, in \citetalias{barnes_inference_2016-1}, though it is difficult to see how a component hotter than 10 MK can be resurrected. Note though that the results of \citet{caspi_new_2015} pose a challenge to this scenario unless an undetected microflare or small flare occurred during the observations.

The observational aspects of this work are addressed more fully in \citetalias{barnes_inference_2016-1}. However, one can conclude (i) present day observations do not seem capable of making quantitative statements about the ``hot'' component, though they are highly suggestive of its existence and (ii) future measurements should be concentrated in the temperature regime \SIrange{e6.6}{e7}{\kelvin} rather than at higher temperatures. The MaGIXS instrument, due to fly in the summer of 2019, is well positioned to do this.
